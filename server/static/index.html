<!DOCTYPE html>
<html lang="en">
<head>

  <title>QREW</title>

  <link href="https://cdn.jsdelivr.net" rel="preconnect" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/boosted@5.1.3/dist/css/boosted.min.css"
        rel="stylesheet"
        integrity="sha384-Di/KMIVcO9Z2MJO3EsrZebWTNrgJTrzEDwAplhM5XnCFQ1aDhRNWrp6CWvVcn00c"
        crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/boosted@5.1.3/dist/js/boosted.bundle.min.js"
          integrity="sha384-5thbp4uNEqKgkl5m+rMBhqR+ZCs+3iAaLIghPWAgOv0VKvzGlYKR408MMbmCjmZF"
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@4.0.7/marked.min.js"
          integrity="sha256-/ZAfMLis+vqzGMtQrkqnXjZ6+RdbCp1k8ysAiYiOKPE="
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@0.24.0/dist/axios.min.js"
          integrity="sha256-rtaseLgkmpx8/wAw87kh7p93HLFoQWTz5nnhAjpNXGk="
          crossorigin="anonymous"></script>
  <link rel="icon" type="image/ico" href="images/favicon.ico">

</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <span class="navbar-text text-primary">
        QREW
      </span>
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <div class="mt-3">
        <label for="input_area" class="form-label">Text input (one line per dialogue turn):</label>
        <textarea class="form-control" id="input_area" rows="10"></textarea>
        <button class="btn btn-primary m-1" onclick="rewrite()">Reformulate !</button>
      </div>
    </div>
    <div class="row">
      <div class="mt-3">
        Reformulated: <span id="output_span"></span>
      </div>
    </div>
  </div>
  <script>

    function rewrite() {
        let output_elt = document.getElementById('output_span');
        let content = document.getElementById("input_area").value;
        let lines = content.split(/\r?\n/);
        console.log(lines);
        axios.post('api/rewrite',{sentence: lines.slice(-1)[0],
                                  context: lines.slice(0,-1)})
            .then(response => {
                console.log(response);
                output_elt.textContent = response.data.sentence;
            })
            .catch(error => {
                console.log(error);
                output_elt.textContent = error.toString();
            });
    }
  </script>

</body>
</html>
